# üü¶ **2.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤**

–ö–æ–≥–¥–∞ –ø–∏—Å—å–º–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫, –æ–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç **–∑–∞–≥–æ–ª–æ–≤–∫–∏** (headers) ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, **–∫–∞–∫** –ø–∏—Å—å–º–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–æ–≤–∞–ª–æ, **–æ—Ç–∫—É–¥–∞** –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å, **–∫–∞–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—à–ª–æ**, **–∫–∞–∫–∏–µ —Å–µ—Ä–≤–µ—Ä—ã –ø–µ—Ä–µ—Å—ã–ª–∫–∏ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª–∏**.

–≠—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ–ª–∞—Ç—å, –ø–æ—ç—Ç–æ–º—É –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –≤–∞–∂–Ω–µ–π—à–µ–π —á–∞—Å—Ç—å—é –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏—à–∏–Ω–≥–∞.

–†–∞–∑–±–µ—Ä—ë–º –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –ø–æ–¥—Ä–æ–±–Ω–æ.

---

# üü© **SPF ‚Äî Sender Policy Framework**

### üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

SPF ‚Äî —ç—Ç–æ DNS-–∑–∞–ø–∏—Å—å –¥–æ–º–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç:

> ¬´–ö–∞–∫–∏–µ –ø–æ—á—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–µ—Ä—ã –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ—á—Ç—É –æ—Ç –∏–º–µ–Ω–∏ –Ω–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞¬ª.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥–æ–º–µ–Ω–∞ google.com –µ—Å—Ç—å SPF-–∑–∞–ø–∏—Å—å, —Ä–∞–∑—Ä–µ—à–∞—é—â–∞—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–∏—Å—å–º–∞ —Ç–æ–ª—å–∫–æ —Å —Å–µ—Ä–≤–µ—Ä–æ–≤ Google.

### üìå –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∏—Å—å–º–µ

–í –∑–∞–≥–æ–ª–æ–≤–∫–µ:

```
Received-SPF: Pass (google.com: domain of example@google.com designates 209.85.219.48 as permitted sender)
```

### üìå –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

–ê–ª–≥–æ—Ä–∏—Ç–º:

1. –ë–µ—Ä—ë–º –¥–æ–º–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, ***paypal.com***).
2. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –µ–≥–æ SPF-–∑–∞–ø–∏—Å—å –≤ DNS (TXT-–∑–∞–ø–∏—Å—å).
3. –ü—Ä–æ–≤–µ—Ä—è–µ–º:
   —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Å–ª–∞–ª –ø–∏—Å—å–º–æ, —Å–ø–∏—Å–∫—É —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.

### üìå –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ

–ï—Å–ª–∏ SPF = FAIL ‚Üí –ø–∏—Å—å–º–æ –ø–æ—á—Ç–∏ —Ç–æ—á–Ω–æ –ø–æ–¥–¥–µ–ª—å–Ω–æ–µ.
SPF FAIL ‚Äî –æ–¥–Ω–æ –∏–∑ —Å–∏–ª—å–Ω–µ–π—à–∏—Ö –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤ —Å–ø—É—Ñ–∏–Ω–≥–∞.

---

# üü¶ **DKIM ‚Äî DomainKeys Identified Mail**

### üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

DKIM ‚Äî —ç—Ç–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø–æ–¥–ø–∏—Å—å –ø–∏—Å—å–º–∞:

* –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å–µ—Ä–≤–µ—Ä –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –ø–∏—Å—å–º–æ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º,
* –ø–æ–ª—É—á–∞—é—â–∏–π —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º (–≤ DNS).

–ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Üí –ø–∏—Å—å–º–æ –±—ã–ª–æ –ø–æ–¥–¥–µ–ª–∞–Ω–æ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–æ.

### üìå –ì–¥–µ –≤ –ø–∏—Å—å–º–µ –≤–∏–¥–Ω–æ

–í –∑–∞–≥–æ–ª–æ–≤–∫–µ:

```
DKIM-Signature: v=1; a=rsa-sha256; d=google.com; s=20161025; ...
```

### üìå –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

1. –í—ã—Ç–∞—â–∏—Ç—å DKIM-–ø–æ–¥–ø–∏—Å—å –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.
2. –ü–æ–ª—É—á–∏—Ç—å –∏–∑ DNS –æ—Ç–∫—Ä—ã—Ç—ã–π –∫–ª—é—á –¥–æ–º–µ–Ω–∞.
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å (–æ–±—ã—á–Ω–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞).

### üìå –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ

–ï—Å–ª–∏ DKIM = FAIL ‚Üí –ø–∏—Å—å–º–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–æ –∏–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å—Ñ–∞–ª—å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ.

---

# üüß **DMARC ‚Äî Domain-based Message Authentication, Reporting & Conformance**

### üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

DMARC ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–æ–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç:

> ¬´–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ SPF –∏–ª–∏ DKIM –ù–ï –ø—Ä–æ—à–ª–∏¬ª.

–ü–æ–ª–∏—Ç–∏–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å:

* none ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å
* quarantine ‚Äî –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —Å–ø–∞–º
* reject ‚Äî –æ—Ç–∫–ª–æ–Ω–∏—Ç—å

### üìå –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å

–í –∑–∞–≥–æ–ª–æ–≤–∫–µ:

```
Authentication-Results: dmarc=pass (p=none) header.from=google.com
```

### üìå –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–æ—à—ë–ª –ª–∏ SPF.
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–æ—à—ë–ª –ª–∏ DKIM.
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –¥–æ–º–µ–Ω –∏–∑ From –¥–æ–º–µ–Ω—É SPF/DKIM (alignment).

### üìå –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ

–ï—Å–ª–∏ DMARC –ø—Ä–æ–ø–∏—Å–∞–Ω –∂—ë—Å—Ç–∫–∏–π (reject), –∞ –ø–∏—Å—å–º–æ –ø—Ä–æ—à–ª–æ ‚Äî —Å –±–æ–ª—å—à–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –æ–Ω–æ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–µ.
–ï—Å–ª–∏ DMARC FAIL ‚Äî –ø–∏—Å—å–º–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ.

---

# üü• **Received ‚Äî –º–∞—Ä—à—Ä—É—Ç –ø–∏—Å—å–º–∞**

### üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–∏—Å—å–º–æ, –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É:

```
Received: from sender.com (123.45.67.89) by mx.google.com ...
```

–≠—Ç–æ —Ü–µ–ø–æ—á–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞.

### üìå –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

1. **–ù–µ–æ–±—ã—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**
   –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–∏—Å—å–º–æ ¬´–æ—Ç –°–±–µ—Ä–±–∞–Ω–∫–∞¬ª —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—à–ª–æ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä –≤ –ù–∏–≥–µ—Ä–∏–∏.

2. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä—ã–∂–∫–æ–≤**
   –§–∏—à–µ—Ä—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ–∫—Å–∏ ‚Üí –º–∞—Ä—à—Ä—É—Ç–æ–≤ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ.

3. **IP-–∞–¥—Ä–µ—Å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä–∞–Ω–µ –±—Ä–µ–Ω–¥–∞**
   –ù–∞–ø—Ä–∏–º–µ—Ä:

   * Apple ‚Üí —Å–µ—Ä–≤–µ—Ä—ã –°–®–ê
   * –°–±–µ—Ä ‚Üí —Å–µ—Ä–≤–µ—Ä—ã –†–§

4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–≤—ã–π —Å–µ—Ä–≤–µ—Ä**
   –ü–µ—Ä–≤—ã–π —Å–µ—Ä–≤–µ—Ä –≤ —Ü–µ–ø–æ—á–∫–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –¥–æ–º–µ–Ω—É –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è.

### üìå –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ

–°–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å –≤—Å—é —Ü–µ–ø–æ—á–∫—É.
–ï—Å–ª–∏ –º–∞—Ä—à—Ä—É—Ç —Å—Ç—Ä–∞–Ω–Ω—ã–π ‚Äî –ø–∏—Å—å–º–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ.

---

# üü¶ **Return-Path vs From ‚Äî –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ**

### üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

–í –ø–∏—Å—å–º–µ –µ—Å—Ç—å:

* **From:** ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–ª–µ–≥–∫–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å)
* **Return-Path:** ‚Äî —ç—Ç–æ —ç–ª. –∞–¥—Ä–µ—Å, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ (–ø–æ–¥–¥–µ–ª–∞—Ç—å —Å–ª–æ–∂–Ω–µ–µ)

–ü—Ä–∏–º–µ—Ä:

```
From: "Apple Support" <support@apple.com>
Return-Path: <noreply@malicious-site.xyz>
```

### ‚ùó –ï—Å–ª–∏ From –∏ Return-Path –°–ò–õ–¨–ù–û –æ—Ç–ª–∏—á–∞—é—Ç—Å—è ‚Üí —Ñ–∏—à–∏–Ω–≥.

### üìå –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

* –°–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ –¥–æ–º–µ–Ω –≤ From –∏ Return-Path?
* Return-Path –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø–∏—Å–µ–º:

  * gmail.com
  * yahoo.com
  * mail.ru
  * etc.

### üìå –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ

–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ–ª–∞—Ç—å –ø–æ–ª–µ From, –Ω–æ Return-Path –æ—Å—Ç–∞—ë—Ç—Å—è —Ä–µ–∞–ª—å–Ω–µ–µ, —á–µ–º From.
–ï—Å–ª–∏ –¥–æ–º–µ–Ω—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Üí –ø–∏—Å—å–º–æ –≤–µ—Ä–æ—è—Ç–Ω–µ–µ —Ñ–∏—à–∏–Ω–≥–æ–≤–æ–µ.

---

# üéØ **–ò—Ç–æ–≥: —á—Ç–æ –∏–º–µ–Ω–Ω–æ –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç**

### –û–Ω –¥–æ–ª–∂–µ–Ω:

‚úî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å SPF ‚Üí PASS/FAIL
‚úî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å DKIM ‚Üí PASS/FAIL
‚úî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å DMARC ‚Üí PASS/FAIL
‚úî —Ä–∞–∑–æ–±—Ä–∞—Ç—å Received –∏ –∏—Å–∫–∞—Ç—å:

* –ª–∏—à–Ω–∏–µ —à–∞–≥–∏
* –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP
* —Å—Ç—Ä–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã
  ‚úî —Å—Ä–∞–≤–Ω–∏—Ç—å From –∏ Return-Path

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ FAIL –∏–ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ ‚Üí –¥–æ–±–∞–≤–ª—è—Ç—å –±–∞–ª–ª—ã —Ä–∏—Å–∫–∞.